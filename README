# Momo Escrow SDK

Universal escrow payments SDK that works everywhere: **Expo, React Native, Node.js, browsers**. Process payments securely with MTN Mobile Money, Orange Money, and more.

---

## Project Structure
```
momo-escrow-sdk/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ README.md
â”œâ”€â”€ .gitignore
â””â”€â”€ src/
    â”œâ”€â”€ index.ts                 # Main export - MomoSDK
    â”œâ”€â”€ types.ts                 # All TypeScript interfaces
    â”œâ”€â”€ crypto.ts               # Web Crypto utilities
    â”œâ”€â”€ http.ts                 # Universal HTTP client
    â”œâ”€â”€ engine.ts               # Core escrow engine
    â””â”€â”€ providers/
        â”œâ”€â”€ index.ts            # Provider exports
        â”œâ”€â”€ base.ts             # Base provider class
        â”œâ”€â”€ mtn.ts              # MTN Mobile Money
        â””â”€â”€ orange.ts           # Orange Money (placeholder)
```

---

## File 1: `package.json`

```json
{
  "name": "momo-escrow-sdk",
  "version": "1.0.0",
  "description": "Universal escrow payments SDK for mobile money - works with Expo, React Native, Node.js, and browsers",
  "type": "module",
  "main": "dist/index.js",
  "types": "dist/index.d.ts",
  "exports": {
    ".": {
      "import": "./dist/index.js",
      "types": "./dist/index.d.ts"
    }
  },
  "scripts": {
    "build": "tsc",
    "dev": "tsc --watch",
    "prepublishOnly": "npm run build"
  },
  "keywords": [
    "escrow",
    "payments",
    "momo",
    "mtn",
    "mobile-money",
    "react-native",
    "expo",
    "sdk"
  ],
  "author": "DIRA",
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/DIRA-digital-era/momo-escrow-sdk"
  },
  "devDependencies": {
    "typescript": "^5.3.0"
  },
  "files": [
    "dist",
    "README.md"
  ]
}
```

---

## File 2: `tsconfig.json`

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ES2020",
    "moduleResolution": "node",
    "lib": ["ES2020", "DOM"],
    "outDir": "dist",
    "rootDir": "src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
}
```

---

## File 3: `.gitignore`

```
node_modules/
dist/
.env
*.log
.DS_Store
.idea
.vscode
```

---

## ğŸš€ What This Does

**Simple**: Sender â†’ Escrow â†’ Receiver with automatic fee deduction  
**Secure**: Built-in encryption and receipt signing  
**Universal**: Works in mobile apps, web apps, and servers  
**Provider Agnostic**: Support for MTN, Orange, and more coming  

---

## ğŸ’¡ Core Concept

```
User A (Sender) â†’ [Escrow Account] â†’ User B (Receiver)
        â†“
    Fee deducted automatically
```

### Real World Examples
- Rental Apps  
- Marketplaces  
- Service Apps  
- P2P Transactions  

---

## ğŸ›  Installation

```bash
npm install momo-escrow-sdk
```

---

## âš¡ Quick Start (5 minutes)

### 1. Import and Setup

```ts
import { MomoSDK } from 'momo-escrow-sdk';

const momo = new MomoSDK({
  provider: 'mtn',
  providerConfig: {
    baseUrl: 'https://sandbox.momodeveloper.mtn.com',
    subscriptionKey: 'your-sub-key-here',
    clientId: 'your-client-id-here',
    clientSecret: 'your-client-secret-here'
  },
  escrowAccount: '233XXXXXXXXX',
  feePercent: 2.5
});
```

---

### 2. Process a Payment

```ts
const result = await momo.initiatePayment({
  amount: 100,
  sender: '233551234567',
  receiver: '233551234568',
  description: 'April rent payment',
  metadata: {
    propertyId: 'prop_123',
    leaseId: 'lease_456',
    dueDate: '2024-04-30'
  }
});

console.log('Payment initiated:', {
  transactionId: result.transactionId,
  status: result.status,
  fee: result.fee,
  netAmount: result.netAmount,
  receipt: result.receipt
});
```

---

### 3. Handle the Result

```ts
if (result.status === 'collection_initiated') {
  console.log('Collecting payment from sender...');
}

const receipt = result.receipt;
console.log('Secure receipt:', {
  id: receipt.id,
  signature: receipt.hmacSignature,
  qrCode: receipt.qrCodeData
});
```

---

## ğŸ”§ Advanced Usage

### Multiple Providers

```ts
const mtnSDK = new MomoSDK({
  provider: 'mtn',
  providerConfig: { /* MTN creds */ },
  escrowAccount: '233XXXXXXXXX',
  feePercent: 2.5
});

const orangeSDK = new MomoSDK({
  provider: 'orange',
  providerConfig: { /* Orange creds */ },
  escrowAccount: '233YYYYYYYYY',
  feePercent: 3.0
});
```

---

### Custom Receipt Data

```ts
await momo.initiatePayment({
  amount: 150,
  sender: '233551234567',
  receiver: '233551234568',
  description: 'Online purchase - iPhone case',
  metadata: {
    productId: 'prod_789',
    orderId: 'order_456',
    customerEmail: 'buyer@example.com',
    shippingAddress: '123 Main St, Accra'
  }
});
```

---

### Error Handling

```ts
try {
  await momo.initiatePayment({
    amount: 100,
    sender: '233551234567',
    receiver: '233551234568'
  });
} catch (error) {
  console.error('Payment failed:', error.message);

  if (error.message.includes('insufficient funds')) {
  } else if (error.message.includes('network')) {
  } else {
  }
}
```

---

## ğŸ— Architecture Explained

### Flow

1. Collection  
2. Fee Processing  
3. Disbursement  
4. Receipt Creation  

### Security
- No sensitive data stored  
- HTTPS enforced  
- Signed receipts  
- Universal crypto  

---

## ğŸŒ Platform Support

### Expo & React Native

```ts
import { MomoSDK } from 'momo-escrow-sdk';

export default function PaymentScreen() {
  const processPayment = async () => {
    const momo = new MomoSDK({ /* config */ });
    const result = await momo.initiatePayment({ /* ... */ });
  };

  return <Button onPress={processPayment} title="Pay Now" />;
}
```

---

### Node.js Backend

```ts
import { MomoSDK } from 'momo-escrow-sdk';
import express from 'express';

const app = express();
const momo = new MomoSDK({ /* config */ });

app.post('/api/payments', async (req, res) => {
  const result = await momo.initiatePayment(req.body);
  res.json(result);
});
```

---

### Browser/Web Apps

```ts
import { MomoSDK } from 'momo-escrow-sdk';

const momo = new MomoSDK({ /* config */ });
const result = await momo.initiatePayment({ /* ... */ });
```

---

## ğŸ”‘ Getting Credentials

### MTN Mobile Money
1. https://momodeveloper.mtn.com  
2. Create sandbox  
3. Collect:
   - subscriptionKey  
   - clientId  
   - clientSecret  
4. Use sandbox numbers  

### Production
- Contact MTN  
- Switch baseUrl  
- Use real numbers  

---

## ğŸ› Troubleshooting

**Invalid phone number**  
Format: `233XXXXXXXXX` or sandbox format  

**Authentication failed**  
Verify all credentials  

**Network error**  
Check connectivity and base URL  

**Insufficient funds**  
Sender needs enough balance  

---

## ğŸ“š API Reference

### Constructor

```ts
new MomoSDK({
  provider: 'mtn' | 'orange',
  providerConfig: {
    baseUrl: string,
    subscriptionKey: string,
    clientId: string,
    clientSecret: string
  },
  escrowAccount: string,
  feePercent: number
});
```

### Methods
- `initiatePayment(params)`  

### Payment Params

```ts
{
  amount: number,
  sender: string,
  receiver: string,
  description?: string,
  metadata?: object
}
```

---

## ğŸ“„ License

MIT License.  
Made by DIRA for the public.

---

## Contact

Email: **diradigitalera@gmail.com**  
WhatsApp: **+237 682 36 64 72**  
Website: **https://dira.free.nf**

**Social Media**  
LinkedIn: linkedin.com/company-dira-dgital-era/  
Instagram: @digital_era_dira  
X: @diradigitalera  
YouTube: @Dira_digital_era  
TikTok: @digital.era.dira  

---

**Let's code!** ğŸš€
